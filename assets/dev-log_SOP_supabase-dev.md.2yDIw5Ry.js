import{_ as e,c as o,o as a,ag as i}from"./chunks/framework.Cs5y-aXb.js";const u=JSON.parse('{"title":"Supabase 本地开发高级标准作业流程 (SOP)","description":"","frontmatter":{},"headers":[],"relativePath":"dev-log/SOP/supabase-dev.md","filePath":"dev-log/SOP/supabase-dev.md","lastUpdated":1767957056000}'),l={name:"dev-log/SOP/supabase-dev.md"};function t(n,s,r,p,d,c){return a(),o("div",null,s[0]||(s[0]=[i(`<h1 id="supabase-本地开发高级标准作业流程-sop" tabindex="-1">Supabase 本地开发高级标准作业流程 (SOP) <a class="header-anchor" href="#supabase-本地开发高级标准作业流程-sop" aria-label="Permalink to &quot;Supabase 本地开发高级标准作业流程 (SOP)&quot;">​</a></h1><h2 id="阶段一-项目初始化与环境建立" tabindex="-1">阶段一：项目初始化与环境建立 <a class="header-anchor" href="#阶段一-项目初始化与环境建立" aria-label="Permalink to &quot;阶段一：项目初始化与环境建立&quot;">​</a></h2><p>此阶段旨在建立一个与特定云端项目相关联的本地开发环境。</p><ol><li><p><strong>CLI 认证 (一次性)</strong>:</p><ul><li>执行 <code>supabase login</code>。</li><li>根据提示在浏览器中完成授权，允许 Supabase CLI 访问你的 Supabase 账户。</li></ul></li><li><p><strong>初始化本地仓库</strong>:</p><ul><li>在你的项目根目录（例如，包含前端代码的目录）下，执行 <code>supabase init</code>。</li><li><strong>说明</strong>: 此命令创建 <code>supabase/</code> 目录，标志着此文件夹为一个 Supabase 本地项目。此时，它<strong>尚未</strong>与任何云端项目关联，只是一个本地脚手架。</li></ul></li><li><p><strong>关联云端项目</strong>:</p><ul><li>执行 <code>supabase link --project-ref &lt;your-project-ref&gt;</code>。</li><li><strong>说明</strong>: 这是将本地项目与云端项目绑定的关键步骤。<code>&lt;your-project-ref&gt;</code> 是你云端项目的唯一 ID。此命令将 ref 写入 <code>supabase/</code> 目录下的文件中，以便后续 <code>db push</code> 等命令知道目标。</li><li><strong>流程顺序</strong>: 推荐的流程是 <code>login</code> -&gt; <code>init</code> -&gt; <code>link</code>。先建立本地结构，再将其与远程目标绑定，逻辑清晰，避免后续操作目标不明。</li></ul></li></ol><h2 id="阶段二-本地服务的管理与监控" tabindex="-1">阶段二：本地服务的管理与监控 <a class="header-anchor" href="#阶段二-本地服务的管理与监控" aria-label="Permalink to &quot;阶段二：本地服务的管理与监控&quot;">​</a></h2><p>此阶段关注如何启动、停止和监控作为开发环境核心的 Docker 容器。</p><ol><li><p><strong>启动本地服务</strong>:</p><ul><li>执行 <code>supabase start</code>。</li><li><strong>说明</strong>: 此命令会拉取必要的 Docker 镜像（Postgres, GoTrue, Realtime 等）并在本地运行它们。</li></ul></li><li><p><strong>高级启动选项</strong>:</p><ul><li><strong>忽略健康检查</strong>: 在启动缓慢或失败时，可使用 <code>supabase start --ignore-health-check</code>。这会跳过对各服务是否正常响应的检查，用于解决特定环境下的启动时序问题。</li><li><strong>排除部分服务</strong>: 为节省系统资源，可编辑 <code>supabase/config.toml</code> 文件，在 <code>[local_development]</code> 部分指定不希望启动的服务。<div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">local_development</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... other configs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">services_to_ignore = [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;realtime&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;imgproxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;edge-runtime&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ul></li><li><p><strong>监控 Docker 容器</strong>:</p><ul><li><strong>命令行</strong>: 执行 <code>docker ps</code>。此命令会列出所有正在运行的容器，包括容器 ID、镜像名称、状态、以及<strong>端口占用情况</strong> (PORTS 列)。这是定位端口冲突和确认服务运行状态的主要方式。</li><li><strong>图形界面</strong>: 打开 Docker Desktop 应用，你可以在容器 (Containers) 标签页直观地看到所有 Supabase 服务的运行状态、CPU/内存占用，并直接访问其日志。</li></ul></li><li><p><strong>停止本地服务</strong>:</p><ul><li>执行 <code>supabase stop</code>。</li><li><strong>说明</strong>: 此命令会停止所有相关的 Docker 容器，并默认创建本地数据库的数据备份。</li><li><strong>无备份停止</strong>: 若不需要保留本地数据库的任何数据（例如，准备进行一次干净的重置测试），可执行 <code>supabase stop --no-backup</code>。</li></ul></li></ol><h2 id="阶段三-开发与迁移工作流" tabindex="-1">阶段三：开发与迁移工作流 <a class="header-anchor" href="#阶段三-开发与迁移工作流" aria-label="Permalink to &quot;阶段三：开发与迁移工作流&quot;">​</a></h2><p>此阶段旨在本地开发并前移结果到云端</p><ol><li><strong>技术验证与数据库设计</strong>: 在本地 Supabase Studio (<code>http://localhost:54323</code>) 的 SQL Editor 和 Table Editor 中完成。</li><li><strong>生成迁移文件</strong>: 完成结构变更后，在终端执行 <code>supabase db diff -f &quot;&lt;description&gt;&quot;</code>，将变更记录为 SQL 文件。</li><li><strong>前端开发</strong>: <ul><li>安装依赖: <code>pnpm add @supabase/supabase-js</code>。</li><li>配置本地环境: 在 <code>.env.development</code> 文件中配置本地服务的 URL 和 Key。</li><li>启动开发服务器: <code>pnpm dev</code>。</li><li>在 IDE 中编写代码，通过 RPC 或其他方式与本地 Supabase API 交互。</li></ul></li></ol><h2 id="阶段四-验证与部署" tabindex="-1">阶段四：验证与部署 <a class="header-anchor" href="#阶段四-验证与部署" aria-label="Permalink to &quot;阶段四：验证与部署&quot;">​</a></h2><ol><li><strong>迁移验证</strong>: 执行 <code>supabase db reset</code>，验证所有迁移文件能够从零开始构建一个完整的数据库。</li><li><strong>部署数据库变更</strong>: 执行 <code>supabase db push</code>，将本地的迁移应用到已链接的云端数据库。</li><li><strong>部署前端应用</strong>: <ul><li>在托管平台（Vercel 等）配置<strong>生产环境</strong>变量。</li><li>执行 <code>pnpm build</code>。</li><li>部署构建产物。</li></ul></li></ol>`,12)]))}const h=e(l,[["render",t]]);export{u as __pageData,h as default};
